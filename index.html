<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spidx Button</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://resources.spidx.app/spidx_auth.js"></script>
    <script>
      window.onload = () => {
            window.SpidxAuth.init({
                apiKey: '243B62AF-BDF4-470F-82D6-E75E905B953C',       // Change to your API Key
                useCaseId: 'FB4BA5AC-793F-49E8-B66D-A90EF3F62E6D',    // Change to your Use Case ID
                elemId: 'spidx-auth',
                environment: 'PROD'
            })
            
            window.SpidxAuth.transactionCallback = async (data) => {
                if (data.transactionStatus == 'OK') {
                    postFace(data.transactionId)
                }
            }
        }

        function postFace(transactionId) {
            var xhr = new XMLHttpRequest();
            xhr.open("POST", 'https://griauletalks.herokuapp.com/face', true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.send(JSON.stringify({
                'guid': transactionId
            }));
            console.log("posted!")
        }
    </script>

</head>
<body>
    <div style='width: 300px; height: 100px'>
        <div class='spidx-button' data-layout_setup='with-button' id='spidx-auth'></div>
    </div>
</body>
</html>